<!-- <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sample Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css' rel='stylesheet' />
</head>
<style>
    body {
        margin: 0;
        padding: 0;
    }

    #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
    }
</style>

<body>
    <div class="container">
        <div id="map"></div>
        <h3 class="text-dark fw-bold">Coordinates</h3>
        <p id="lat" class="text-dark">&ensp; Latitude:</p>
        <p id="long" class="text-dark">&ensp; Longitude:</p> <br>
        <p class="fst-italic text-secondary m-0">Notice: Disregard this, for test chuchu purpose only:</p>
        <p id="acc" class="text-secondary fst-italic">&ensp; Accuracy:</p>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
<script src='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
<script src="app.js"></script>
</html> -->


<!-- google maps API -->

<!-- <!DOCTYPE html>
<html>

<head> -->
<!-- <title>Simple Marker</title> -->
<!-- The callback parameter is required, so we use console.debug as a noop -->
<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script async
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDYtN3BNCcHFJXpQXrNMxKxIsc9-Pdd-0&callback=console.debug&libraries=maps,marker&v=beta">
        </script> -->
<!-- <script async
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDYtN3BNCcHFJXpQXrNMxKxIsc9-Pdd-0&callback=initMap&libraries=maps,marker&v=beta">
        </script> -->
<!-- <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
        /* gmp-map {
            height: 70%;
            width: 50%;
        } */

        /* Optional: Makes the sample page fill the window. */
        /* html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #map {
            height: 400px;
            width: 100%;
        } */
    </style> -->
<!-- </head> -->
<!-- 11.240186748500088, 125.00284663358609 -->

<!-- <body>
    <gmp-map class="mx-auto container" center="11.240029883135003, 125.00268827609003" zoom="16" map-id="DEMO_MAP_ID">
        <gmp-advanced-marker position="11.238277945581412, 125.00150250628963" title="Second location"></gmp-advanced-marker>
        <gmp-advanced-marker id="current-location" position="11.240029883135003, 125.00268827609003" title="First location">            
            <img id="current-location-img" class="rounded-circle border border-danger" src="inay-profile.jpg" style="width: 40px; height: 40px;" alt="Custom Marker Icon">
        </gmp-advanced-marker>
    </gmp-map> -->
<!-- <div id="map"></div> -->
<!-- <input id="range" type="range" min="1" max="130"><br> -->
<!-- <span id="num">1</span> -->
<!-- </body>
<script src="app.js"></script>

</html> -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Map Autocomplete</title>
    <!-- <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDYtN3BNCcHFJXpQXrNMxKxIsc9-Pdd-0&callback=initAutocomplete&libraries=maps,marker,places&v=beta"></script> -->
    <!-- <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDYtN3BNCcHFJXpQXrNMxKxIsc9-Pdd-0&loading=async&libraries=places&callback=initAutocomplete"></script>     -->
    <script async
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDYtN3BNCcHFJXpQXrNMxKxIsc9-Pdd-0&callback=initMap&libraries=maps,marker,places&v=beta"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<style>
    #map {
        width: 700px;
        height: 500px;
    }
</style>

<body>
    <input id="autocomplete" type="text" placeholder="Aa" style="width: 500px;">
    <!-- <gmp-map class="" center="11.240029883135003, 125.00268827609003" zoom="16" map-id="DEMO_MAP_ID" style="width: 700px; height: 500px;"> -->
    <!-- <gmp-advanced-marker position="11.238277945581412, 125.00150250628963" title="Location"></gmp-advanced-marker>         -->
    <!-- <gmp-advanced-marker id="current-location" position="11.240029883135003, 125.00268827609003" title="First location">            
            <img id="current-location-img" class="rounded-circle border border-danger" src="inay-profile.jpg" style="width: 40px; height: 40px;" alt="Custom Marker Icon">
        </gmp-advanced-marker> -->
    <!-- </gmp-map> -->
    <div id="map">

    </div>
</body>
<script>
    // let autoComplete;
    // function initAutocomplete() {
    //     autoComplete = new google.maps.places.Autocomplete(
    //         document.getElementById('autocomplete'), {
    //             // types: ['establishment'],
    //             // componentRestrictions: {'country': ['AU']},
    //             // fields: ['address_component', 'geometry', 'place_id', 'icon', 'geometry', 'name']
    //             fields: ['ALL']
    //         }
    //     );

    //     autoComplete.addListener('place_changed', () => {
    //         var place = autoComplete.getPlace();

    //         if (!place.geometry) {
    //             document.getElementById('autocomplete').placeholder = 'Enter a place';
    //         } else {
    //             console.log(place.geometry.location.lat() + ', ' + place.geometry.location.lng());
    //             var gmp = document.querySelector('gmp-map')
    //             gmp.setAttribute('center', place.geometry.location.lat() + ', ' + place.geometry.location.lng());
    //             // document.querySelector('gmp-advanced-marker').setAttribute('position', place.geometry.location.lat() + ', ' + place.geometry.location.lng());
    //             var marker = document.createElement('gmp-advanced-marker');
    //             marker.setAttribute('position', place.geometry.location.lat() + ', ' + place.geometry.location.lng());
    //             marker.setAttribute('title', 'Place Title');
    //             gmp.appendChild(marker);

    //             marker.addEventListener('click', () => {
    //                 gmp.innerHTML = '';
    //             })
    //         }
    //     });
    // }




    // 11.240029883135003, 125.00268827609003
    // Script Map
    let autoComplete;
    let map;
    let coordinates = {
        lat: 11.240029883135003,
        lng: 125.00268827609003
    }

    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: coordinates,
            zoom: 16
        });

        autoComplete = new google.maps.places.Autocomplete(
            document.getElementById('autocomplete'), {
            // types: ['establishment'],
            // componentRestrictions: {'country': ['AU']},
            // fields: ['address_component', 'geometry', 'place_id', 'icon', 'geometry', 'name']
            fields: ['ALL']
        }
        );

        drawCircle(map, 5);
        
        var partialCoods = [
            {
                lat: 11.240029883135003,
                lng: 125.00268827609003
            },
            {
                lat: 11.238970568745978,
                lng: 125.00234514948566
            },
            {
                lat: 11.241691367994054,
                lng: 125.00062299218652
            },
            {
                lat: 11.250301832718364,
                lng: 125.00532998067818
            },
        ]

        autoComplete.addListener('place_changed', () => {
            var place = autoComplete.getPlace();

            if (!place.geometry) {
                alert('Please select a provided address');
            } else {
                coordinates = {
                    lat: place.geometry.location.lat(),
                    lng: place.geometry.location.lng()
                };

                map = new google.maps.Map(document.getElementById('map'), {
                    center: coordinates,
                    zoom: 16
                });


                partialCoods.forEach(coords => {
                    if (calculateDistance(coordinates.lat, coordinates.lng, coords.lat, coords.lng) <= 1) {
                        var marker = new google.maps.Marker({
                            position: coords,
                            map: map,
                            title: 'First Marker Sample',
                            icon: {
                                url: 'inay-profile.jpg',
                                scaledSize: new google.maps.Size(40, 40)
                            },
                            id: 1
                        });

                        var currentLocation = new google.maps.Marker({
                            position: coordinates,
                            map: map,
                            title: 'Current Location'
                        });

                        marker.addListener('click', function () {
                            var id = marker.id;
                            console.log(id);
                        });
                    } else {
                        console.log('outside the boundary');
                    }
                });

                drawCircle(map, 1);
                console.log(place.geometry.location.lat() + ', ' + place.geometry.location.lng());
                console.log(partialCoods.length);
            }
        });
    }

    function drawCircle(map, proximity) {
        var circle = new google.maps.Circle({
            strokeColor: '#FF0000',
            strokeOpacity: 0.8,
            strokeWeight: 2,
            fillColor: '#FF0000',
            fillOpacity: 0,
            map: map,
            center: coordinates,
            radius: proximity * 1000
        });
    }

    function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 6371; // Radius of the Earth in kilometers
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a =
            Math.sin(dLat / 2) * Math.sin(dLat / 2) +
            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
            Math.sin(dLon / 2) * Math.sin(dLon / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        const distance = R * c; // Distance in kilometers
        return distance;
    }

</script>

</html>